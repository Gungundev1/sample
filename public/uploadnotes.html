<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Upload Notes (No Firebase)</title>
  <style>
    body { font-family: sans-serif; display: flex; margin: 0; height: 100vh; }
    .container { display: flex; width: 100%; }
    .left, .right { flex: 1; padding: 20px; box-sizing: border-box; }
    .left { background: #ddd; }
    .right { background: #eee; overflow-y: auto; }
    input, button { display: block; width: 100%; margin: 10px 0; padding: 10px; }
    .note { background: white; padding: 10px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 0 5px #ccc; }
    .note img { max-width: 100%; border-radius: 5px; margin-top: 10px; }
  </style>
</head>
<body>

<div class="container">
  <div class="left">
    <h2>Upload Notes</h2>
    <input type="text" id="noteTitle" placeholder="Enter Title">
    <input type="file" id="noteFile" accept="image/*">
    <button onclick="uploadNote()">Upload</button>
  </div>
  <div class="right">
    <h2>Uploaded Notes</h2>
    <div id="notesList"></div>
  </div>
</div>

<script>
  
  const notes = [];


async function uploadNote() {
  const title = document.getElementById('noteTitle').value;
  const fileInput = document.getElementById('noteFile');
  const file = fileInput.files[0];

  if (!title || !file) {
    alert('Please provide both title and image.');
    return;
  }

  const formData = new FormData();
  formData.append('title', title);
  formData.append('file', file);

  try {
    const response = await fetch('http://localhost:3000/upload', {
      method: 'POST',
      body: formData,
    });
    const result = await response.json();
    if (result.success) {
      // Add the uploaded note to the UI
      notes.unshift(result.note);
      displayNotes();
      fileInput.value = '';
      document.getElementById('noteTitle').value = '';
    }
  } catch (error) {
    console.error('Upload failed:', error);
  }
}


window.onload = async function() {
  try {
    const response = await fetch('http://localhost:3000/notes');
    const data = await response.json();
    notes.push(...data); // Load existing notes from server
    displayNotes();
  } catch (error) {
    console.error('Failed to fetch notes:', error);
  }
}
</script>
</body>
</html>